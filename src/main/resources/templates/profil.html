<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org" data-theme="light">

<head>
    <meta charset="UTF-8">
    <title>Mon Profil - LocAuto</title>

    <!-- DaisyUI + Tailwind -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" th:href="@{/css/style.css}" type="text/css">
</head>

<body class="min-h-screen bg-base-200">

    <!-- NAVBAR -->
    <div class="navbar bg-base-100 shadow-sm border-b border-base-300">
        <div class="flex-1 px-4">
            <a th:href="@{/}" class="btn btn-ghost normal-case text-xl font-bold gap-2">
                <span class="text-primary text-2xl">üë§</span>
                <span>Mon profil</span>
            </a>
        </div>
        <div class="flex-none px-4">
            <a th:href="@{/}" class="btn btn-ghost btn-sm">
                ‚¨Ö Accueil
            </a>
        </div>
    </div>

    <!-- CONTENU -->
    <main class="max-w-3xl mx-auto px-4 py-8">
        <!-- Cas erreur : pas d'utilisateur -->
        <div th:if="${monUtilisateur == null}" class="flex justify-center">
            <div class="card bg-base-100 shadow-xl border border-error/30 max-w-md w-full">
                <div class="card-body items-center text-center space-y-4">
                    <div class="text-4xl">‚ö†Ô∏è</div>
                    <h2 class="card-title text-error">Erreur</h2>
                    <p class="text-sm text-base-content/70">
                        Impossible de r√©cup√©rer les informations de l'utilisateur.
                    </p>
                    <a th:href="@{/login}" class="btn btn-primary btn-sm">
                        Se connecter
                    </a>
                </div>
            </div>
        </div>

        <!-- Cas normal : profil affich√© -->
        <div th:if="${monUtilisateur != null}" class="space-y-6">
            <!-- Carte principale -->
            <section class="card bg-base-100 shadow-xl border border-base-300">
                <div class="card-body gap-6 md:flex md:flex-row md:items-center">
                    <!-- Avatar -->
                    <div class="flex justify-center md:justify-start">
                        <div class="avatar placeholder">
                            <div
                                class="bg-primary text-primary-content rounded-full w-24 h-24 flex items-center justify-center text-3xl font-bold">
                                <span
                                    th:text="${#strings.substring(monUtilisateur.prenom,0,1)} + ${#strings.substring(monUtilisateur.nom,0,1)}">
                                    JD
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Infos principales -->
                    <div class="flex-1 space-y-2 text-center md:text-left">
                        <h1 class="text-2xl font-extrabold">
                            <span th:text="${monUtilisateur.prenom} + ' ' + ${monUtilisateur.nom}">VISITEUR INCONNU
                            </span>
                        </h1>
                        <p class="text-sm text-base-content/70">
                            <span th:text="${monUtilisateur.email}">visiteur@inconnu.com</span>
                        </p>

                        <div class="flex flex-wrap gap-2 justify-center md:justify-start pt-1">
                            <span class="badge badge-primary badge-outline" th:text="${roleActif}">
                                VISITEUR
                            </span>
                            <span class="badge badge-ghost badge-sm">
                                ID #<span th:text="${monUtilisateur.id}">-1</span>
                            </span>
                        </div>
                    </div>

                    <!-- Actions principales -->
                    <div class="flex flex-col gap-2 w-full md:w-auto">
                        <a th:href="@{/profil/edit}" class="btn btn-primary btn-sm w-full">
                            ‚úèÔ∏è Modifier mon profil
                        </a>

                        <a th:href="@{/api/auth/logout-page}" class="btn btn-ghost btn-sm text-error w-full"
                            onclick="event.preventDefault(); document.getElementById('logout-form').submit();">
                            D√©connexion
                        </a>

                        <form id="logout-form" th:action="@{/api/auth/logout}" method="post" class="hidden">
                        </form>
                    </div>
                </div>
            </section>

            <!-- Grille des informations -->
            <section class="grid gap-4 md:grid-cols-2">
                <!-- Infos personnelles -->
                <div class="card bg-base-100 shadow-md border border-base-300">
                    <div class="card-body space-y-3">
                        <h3 class="font-semibold text-base flex items-center gap-2">
                            <span class="text-lg">üë§</span> Informations personnelles
                        </h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between gap-2">
                                <span class="text-base-content/60">Date de naissance :</span>
                                <span class="font-medium" th:text="${monUtilisateur.dateNaissance}">**/**/****</span>
                            </div>
                            <div class="flex justify-between gap-2">
                                <span class="text-base-content/60">T√©l√©phone :</span>
                                <span class="font-medium" th:text="${monUtilisateur.telephone}">** ** ** ** **</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Adresse -->
                <div class="card bg-base-100 shadow-md border border-base-300">
                    <div class="card-body space-y-3">
                        <h3 class="font-semibold text-base flex items-center gap-2">
                            <span class="text-lg">üè†</span> Adresse
                        </h3>
                        <div class="space-y-2 text-sm">
                            <div>
                                <div class="text-base-content/60 text-xs">Rue</div>
                                <div class="font-medium" th:text="${monUtilisateur.rue}">Rue inconnue</div>
                            </div>
                            <div>
                                <div class="text-base-content/60 text-xs">Ville / Pays</div>
                                <div class="font-medium">
                                    <span th:text="${monUtilisateur.ville}">****</span>,
                                    <span th:text="${monUtilisateur.pays}">****</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Permis -->
                <div class="card bg-base-100 shadow-md border border-base-300">
                    <div class="card-body space-y-3">
                        <h3 class="font-semibold text-base flex items-center gap-2">
                            <span class="text-lg">üöò</span> Permis de conduire
                        </h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between gap-2">
                                <span class="text-base-content/60">Num√©ro :</span>
                                <span class="font-medium" th:text="${monUtilisateur.numeroPermis}">Non renseign√©</span>
                            </div>
                            <div class="flex justify-between gap-2">
                                <span class="text-base-content/60">Date d'obtention :</span>
                                <span class="font-medium"
                                    th:text="${monUtilisateur.dateObtentionPermis}">****-**-**</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Portefeuille -->
                <div class="card bg-base-100 shadow-md border border-base-300">
                    <div class="card-body space-y-3">
                        <h3 class="font-semibold text-base flex items-center gap-2">
                            <span class="text-lg">üí≥</span> Mon portefeuille
                        </h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between items-center gap-2">
                                <span class="text-base-content/60">Solde actuel</span>
                                <span class="text-2xl font-black text-success">
                                    <span th:text="${monUtilisateur.solde}">--.--</span> ‚Ç¨
                                </span>
                            </div>
                            <p class="text-xs text-base-content/60">
                                Utilisable pour vos prochaines locations ou services.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Boutons de navigation -->
            <section class="flex flex-wrap gap-3 justify-end pt-2">
                <a th:href="@{/}" class="btn btn-ghost btn-sm">
                    ‚¨Ö Acceuil
                </a>
            </section>
        </div>
    </main>

</body>

</html>